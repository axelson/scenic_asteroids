!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";n.r(t);n(3),n(2);var i,s=e=>{if("function"==typeof e)return e;return function(){return e}},o="undefined"!=typeof self?self:null,r="undefined"!=typeof window?window:null,a=o||r||void 0,h=0,c=1,l=2,u=3,d="closed",f="errored",p="joined",g="joining",m="leaving",w="phx_close",b="phx_error",y="phx_join",v="phx_reply",k="phx_leave",C="longpoll",E="websocket",j=4,R=class{constructor(e,t,n,i){this.channel=e,this.event=t,this.payload=n||function(){return{}},this.receivedResp=null,this.timeout=i,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(e){this.timeout=e,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(e,t){return this.hasReceived(e)&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:e,response:t,_ref:n}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,e=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=e,this.matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}trigger(e,t){this.channel.trigger(this.refEvent,{status:e,response:t})}},T=class{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}},_=class{static request(e,t,n,i,s,o,r){if(a.XDomainRequest){let n=new a.XDomainRequest;this.xdomainRequest(n,e,t,i,s,o,r)}else{let h=new a.XMLHttpRequest;this.xhrRequest(h,e,t,n,i,s,o,r)}}static xdomainRequest(e,t,n,i,s,o,r){e.timeout=s,e.open(t,n),e.onload=(()=>{let t=this.parseJSON(e.responseText);r&&r(t)}),o&&(e.ontimeout=o),e.onprogress=(()=>{}),e.send(i)}static xhrRequest(e,t,n,i,s,o,r,a){e.open(t,n,!0),e.timeout=o,e.setRequestHeader("Content-Type",i),e.onerror=(()=>{a&&a(null)}),e.onreadystatechange=(()=>{if(e.readyState===j&&a){let t=this.parseJSON(e.responseText);a(t)}}),r&&(e.ontimeout=r),e.send(s)}static parseJSON(e){if(!e||""===e)return null;try{return JSON.parse(e)}catch(t){return console&&console.log("failed to parse JSON response",e),null}}static serialize(e,t){let n=[];for(var i in e){if(!Object.prototype.hasOwnProperty.call(e,i))continue;let s=t?`${t}[${i}]`:i,o=e[i];"object"==typeof o?n.push(this.serialize(o,s)):n.push(encodeURIComponent(s)+"="+encodeURIComponent(o))}return n.join("&")}static appendParams(e,t){if(0===Object.keys(t).length)return e;return`${e}${e.match(/\?/)?"&":"?"}${this.serialize(t)}`}},S=class{constructor(e){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(e),this.readyState=h,this.poll()}normalizeEndpoint(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+E),"$1/"+C)}endpointURL(){return _.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(){this.close(),this.readyState=h}ontimeout(){this.onerror("timeout"),this.closeAndRetry()}poll(){this.readyState!==c&&this.readyState!==h||_.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),e=>{if(e){var{status:t,token:n,messages:i}=e;this.token=n}else t=0;switch(t){case 200:i.forEach(e=>{setTimeout(()=>{this.onmessage({data:e})},0)}),this.poll();break;case 204:this.poll();break;case 410:this.readyState=c,this.onopen(),this.poll();break;case 403:this.onerror(),this.close();break;case 0:case 500:this.onerror(),this.closeAndRetry();break;default:throw new Error(`unhandled poll status ${t}`)}})}send(e){_.request("POST",this.endpointURL(),"application/json",e,this.timeout,this.onerror.bind(this,"timeout"),e=>{e&&200===e.status||(this.onerror(e&&e.status),this.closeAndRetry())})}close(e,t){this.readyState=u,this.onclose()}},A={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encode(e,t){if(e.payload.constructor===ArrayBuffer)return t(this.binaryEncode(e));{let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}},decode(e,t){if(e.constructor===ArrayBuffer)return t(this.binaryDecode(e));{let[n,i,s,o,r]=JSON.parse(e);return t({join_ref:n,ref:i,topic:s,event:o,payload:r})}},binaryEncode(e){let{join_ref:t,ref:n,event:i,topic:s,payload:o}=e,r=this.META_LENGTH+t.length+n.length+s.length+i.length,a=new ArrayBuffer(this.HEADER_LENGTH+r),h=new DataView(a),c=0;h.setUint8(c++,this.KINDS.push),h.setUint8(c++,t.length),h.setUint8(c++,n.length),h.setUint8(c++,s.length),h.setUint8(c++,i.length),Array.from(t,e=>h.setUint8(c++,e.charCodeAt(0))),Array.from(n,e=>h.setUint8(c++,e.charCodeAt(0))),Array.from(s,e=>h.setUint8(c++,e.charCodeAt(0))),Array.from(i,e=>h.setUint8(c++,e.charCodeAt(0)));var l=new Uint8Array(a.byteLength+o.byteLength);return l.set(new Uint8Array(a),0),l.set(new Uint8Array(o),a.byteLength),l.buffer},binaryDecode(e){let t=new DataView(e),n=t.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.push:return this.decodePush(e,t,i);case this.KINDS.reply:return this.decodeReply(e,t,i);case this.KINDS.broadcast:return this.decodeBroadcast(e,t,i)}},decodePush(e,t,n){let i=t.getUint8(1),s=t.getUint8(2),o=t.getUint8(3),r=this.HEADER_LENGTH+this.META_LENGTH-1,a=n.decode(e.slice(r,r+i));r+=i;let h=n.decode(e.slice(r,r+s));r+=s;let c=n.decode(e.slice(r,r+o));return r+=o,{join_ref:a,ref:null,topic:h,event:c,payload:e.slice(r,e.byteLength)}},decodeReply(e,t,n){let i=t.getUint8(1),s=t.getUint8(2),o=t.getUint8(3),r=t.getUint8(4),a=this.HEADER_LENGTH+this.META_LENGTH,h=n.decode(e.slice(a,a+i));a+=i;let c=n.decode(e.slice(a,a+s));a+=s;let l=n.decode(e.slice(a,a+o));a+=o;let u=n.decode(e.slice(a,a+r));a+=r;let d=e.slice(a,e.byteLength);return{join_ref:h,ref:c,topic:l,event:v,payload:{status:u,response:d}}},decodeBroadcast(e,t,n){let i=t.getUint8(1),s=t.getUint8(2),o=this.HEADER_LENGTH+2,r=n.decode(e.slice(o,o+i));o+=i;let a=n.decode(e.slice(o,o+s));return o+=s,{join_ref:null,ref:null,topic:r,event:a,payload:e.slice(o,e.byteLength)}}},L=new class{constructor(e,t={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=t.timeout||1e4,this.transport=t.transport||a.WebSocket||S,this.establishedConnections=0,this.defaultEncoder=A.encode.bind(A),this.defaultDecoder=A.decode.bind(A),this.closeWasClean=!1,this.binaryType=t.binaryType||"arraybuffer",this.connectClock=1,this.transport!==S?(this.encode=t.encode||this.defaultEncoder,this.decode=t.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder);let n=null;r&&r.addEventListener&&(r.addEventListener("pagehide",e=>{this.conn&&(this.disconnect(),n=this.connectClock)}),r.addEventListener("pageshow",e=>{n===this.connectClock&&(n=null,this.connect())})),this.heartbeatIntervalMs=t.heartbeatIntervalMs||3e4,this.rejoinAfterMs=(e=>t.rejoinAfterMs?t.rejoinAfterMs(e):[1e3,2e3,5e3][e-1]||1e4),this.reconnectAfterMs=(e=>t.reconnectAfterMs?t.reconnectAfterMs(e):[10,50,100,150,200,250,500,1e3,2e3][e-1]||5e3),this.logger=t.logger||null,this.longpollerTimeout=t.longpollerTimeout||2e4,this.params=s(t.params||{}),this.endPoint=`${e}/${E}`,this.vsn=t.vsn||"2.0.0",this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new T(()=>{this.teardown(()=>this.connect())},this.reconnectAfterMs)}replaceTransport(e){this.disconnect(),this.transport=e}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let e=_.appendParams(_.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return"/"!==e.charAt(0)?e:"/"===e.charAt(1)?`${this.protocol()}:${e}`:`${this.protocol()}://${location.host}${e}`}disconnect(e,t,n){this.connectClock++,this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,t,n)}connect(e){this.connectClock++,e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=s(e)),this.conn||(this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=(()=>this.onConnOpen()),this.conn.onerror=(e=>this.onConnError(e)),this.conn.onmessage=(e=>this.onConnMessage(e)),this.conn.onclose=(e=>this.onConnClose(e)))}log(e,t,n){this.logger(e,t,n)}hasLogger(){return null!==this.logger}onOpen(e){let t=this.makeRef();return this.stateChangeCallbacks.open.push([t,e]),t}onClose(e){let t=this.makeRef();return this.stateChangeCallbacks.close.push([t,e]),t}onError(e){let t=this.makeRef();return this.stateChangeCallbacks.error.push([t,e]),t}onMessage(e){let t=this.makeRef();return this.stateChangeCallbacks.message.push([t,e]),t}onConnOpen(){this.hasLogger()&&this.log("transport",`connected to ${this.endPointURL()}`),this.closeWasClean=!1,this.establishedConnections++,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach(([,e])=>e())}heartbeatTimeout(){this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.abnormalClose("heartbeat timeout"))}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearTimeout(this.heartbeatTimer),setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs))}teardown(e,t,n){if(!this.conn)return e&&e();this.waitForBufferDone(()=>{this.conn&&(t?this.conn.close(t,n||""):this.conn.close()),this.waitForSocketClosed(()=>{this.conn&&(this.conn.onclose=function(){},this.conn=null),e&&e()})})}waitForBufferDone(e,t=1){5!==t&&this.conn&&this.conn.bufferedAmount?setTimeout(()=>{this.waitForBufferDone(e,t+1)},150*t):e()}waitForSocketClosed(e,t=1){5!==t&&this.conn&&this.conn.readyState!==u?setTimeout(()=>{this.waitForSocketClosed(e,t+1)},150*t):e()}onConnClose(e){this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),clearTimeout(this.heartbeatTimer),this.closeWasClean||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(([,t])=>t(e))}onConnError(e){this.hasLogger()&&this.log("transport",e);let t=this.transport,n=this.establishedConnections;this.stateChangeCallbacks.error.forEach(([,i])=>{i(e,t,n)}),(t===this.transport||n>0)&&this.triggerChanError()}triggerChanError(){this.channels.forEach(e=>{e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(b)})}connectionState(){switch(this.conn&&this.conn.readyState){case h:return"connecting";case c:return"open";case l:return"closing";default:return"closed"}}isConnected(){return"open"===this.connectionState()}remove(e){this.off(e.stateChangeRefs),this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}off(e){for(let t in this.stateChangeCallbacks)this.stateChangeCallbacks[t]=this.stateChangeCallbacks[t].filter(([t])=>-1===e.indexOf(t))}channel(e,t={}){let n=new class{constructor(e,t,n){this.state=d,this.topic=e,this.params=s(t||{}),this.socket=n,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new R(this,y,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new T(()=>{this.socket.isConnected()&&this.rejoin()},this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError(()=>this.rejoinTimer.reset())),this.stateChangeRefs.push(this.socket.onOpen(()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()})),this.joinPush.receive("ok",()=>{this.state=p,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this.joinPush.receive("error",()=>{this.state=f,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=d,this.socket.remove(this)}),this.onError(e=>{this.socket.hasLogger()&&this.socket.log("channel",`error ${this.topic}`,e),this.isJoining()&&this.joinPush.reset(),this.state=f,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new R(this,k,s({}),this.timeout).send(),this.state=f,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.on(v,(e,t)=>{this.trigger(this.replyEventName(t),e)})}join(e=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(e){this.on(w,e)}onError(e){return this.on(b,t=>e(t))}on(e,t){let n=this.bindingRef++;return this.bindings.push({event:e,ref:n,callback:t}),n}off(e,t){this.bindings=this.bindings.filter(n=>!(n.event===e&&(void 0===t||t===n.ref)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,n=this.timeout){if(t=t||{},!this.joinedOnce)throw new Error(`tried to push '${e}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let i=new R(this,e,function(){return t},n);return this.canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}leave(e=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=m;let t=()=>{this.socket.hasLogger()&&this.socket.log("channel",`leave ${this.topic}`),this.trigger(w,"leave")},n=new R(this,k,s({}),e);return n.receive("ok",()=>t()).receive("timeout",()=>t()),n.send(),this.canPush()||n.trigger("ok",{}),n}onMessage(e,t,n){return t}isMember(e,t,n,i){return!(this.topic!==e||i&&i!==this.joinRef()&&(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:t,payload:n,joinRef:i}),1))}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=g,this.joinPush.resend(e))}trigger(e,t,n,i){let s=this.onMessage(e,t,n,i);if(t&&!s)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");let o=this.bindings.filter(t=>t.event===e);for(let e=0;e<o.length;e++)o[e].callback(s,n,i||this.joinRef())}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===d}isErrored(){return this.state===f}isJoined(){return this.state===p}isJoining(){return this.state===g}isLeaving(){return this.state===m}}(e,t,this);return this.channels.push(n),n}push(e){if(this.hasLogger()){let{topic:t,event:n,payload:i,ref:s,join_ref:o}=e;this.log("push",`${t} ${n} (${o}, ${s})`,i)}this.isConnected()?this.encode(e,e=>this.conn.send(e)):this.sendBuffer.push(()=>this.encode(e,e=>this.conn.send(e)))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}sendHeartbeat(){this.pendingHeartbeatRef&&!this.isConnected()||(this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatTimer=setTimeout(()=>this.heartbeatTimeout(),this.heartbeatIntervalMs))}abnormalClose(e){this.closeWasClean=!1,this.isConnected()&&this.conn.close(1e3,e)}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:n,payload:i,ref:s,join_ref:o}=e;s&&s===this.pendingHeartbeatRef&&(clearTimeout(this.heartbeatTimer),this.pendingHeartbeatRef=null,setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)),this.hasLogger()&&this.log("receive",`${i.status||""} ${t} ${n} ${s&&"("+s+")"||""}`,i);for(let e=0;e<this.channels.length;e++){const r=this.channels[e];r.isMember(t,n,i,o)&&r.trigger(n,i,s,o)}for(let t=0;t<this.stateChangeCallbacks.message.length;t++){let[,n]=this.stateChangeCallbacks.message[t];n(e)}})}leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t.isJoined()||t.isJoining()));t&&(this.hasLogger()&&this.log("transport",`leaving duplicate topic "${e}"`),t.leave())}}("/socket",{params:window.SocketExports});if(document.querySelector("#game")){L.connect(),i=L.channel("lobby",window.SocketExports);window.onDirection=function(e){e=P(e),console.log("Send direction: ".concat(e)),i.push("player_direction",{direction:e})},window.onClearDirection=function(e){e=P(e),i.push("clear_player_direction",{direction:e})},window.onSendShoot=function(){i.push("try_shoot",{})},window.onSendShootDirection=function(e,t){var n={x:e,y:t};console.log("obj",n),i.push("try_shoot_direction",n)},window.onClearShooting=function(){i.push("clear_shooting",{})},window.onRotateLeft=function(){console.log("rot left!"),i.push("rotate_left",{})},window.onClearRotateLeft=function(){i.push("clear_rotate_left",{})},window.onRotateRight=function(){i.push("rotate_right",{})},window.onClearRotateRight=function(){i.push("clear_rotate_right",{})},window.SocketExports&&i.join().receive("ok",function(e){console.log("Joined!",e)}).receive("error",function(e){var t=e.reason;console.log("Unable to join: ".concat(t)),alert("Unable to join: ".concat(t))})}else console.warn("unable to find #game div!");function P(e){switch(e){case"left":return"left";case"up":return"up";case"right":return"right";case"down":return"down";default:throw"unhandled direction ".concat(e)}}n(1);console.log("main");var D=!1;!function(e,t){!function(){var e=document.getElementById("login-form"),t=document.getElementById("username-input"),n=document.getElementById("jason-login-btn");n&&n.addEventListener("click",function(n){console.log("logging in as jason"),n.preventDefault(),t.value="jason",e.submit()})}(),jQuery("#fullscreen-button").on("click",function(e){window.game.scale.isFullscreen?window.game.scale.stopFullscreen():window.game.scale.startFullscreen()}),t.on("game_start",function(){D||(window.onCreateGame(),jQuery("#waiting-message").hide(),jQuery("#player-instructions").show(),jQuery("#fullscreen-button").show()),D=!0,t.push("request_player_color",{})}),t.on("player_color",function(e){console.log("msg",e),jQuery("#player-color-value").text(e.color).css({color:function(e){switch(e){case"orange_red":return"orangered";case"powder_blue":return"powderblue";default:return e}}(e.color)}),jQuery("#player-color").show()}),t.onClose(function(){console.log("channel closed!")}),t.onError(function(e){console.log("lobby channel error",e)}),e.onOpen(function(){jQuery("#disconnected-message").hide()}),e.onError(function(t){e.isConnected()?jQuery("#disconnected-message").hide():jQuery("#disconnected-message").show()})}(L,i)},function(e,t){var n,i,s,o,r={type:Phaser.AUTO,width:480,height:210,scale:{mode:Phaser.Scale.FIT},physics:{default:"arcade",arcade:{gravity:{y:200}}},scene:{preload:function(){this.load.image("arrow","/images/arrow.png")},create:function(){(function(){s.create(h+50,c,"arrow").setInteractive().name="right-arrow";var e=s.create(h,c+50,"arrow").setInteractive();e.name="down-arrow",e.angle=90;var t=s.create(h-50,c,"arrow").setInteractive();t.name="left-arrow",t.angle=180;var n=s.create(h,c-50,"arrow").setInteractive();n.name="up-arrow",n.angle=270})(s=this.physics.add.staticGroup()),this.input.on("gameobjectdown",function(e,t){if(f(t)){var n=d(t);console.log("send",n),m(n)}else console.log("clicked on",t.name)}),this.input.on("gameobjectup",function(e,t){if(f(t)){var n=d(t);console.log("done",n),w(n)}}),n=this.input.keyboard.createCursorKeys(),i={};var e=this.add.graphics({fillStyle:{color:65280}}),t=new Phaser.Geom.Circle(l,u,15);e.fillCircleShape(t),this.input.on("pointerdown",function(e){console.log("down!");var t=e.x,n=e.y;console.log("x: ".concat(t," y:").concat(n));var i=t-l,s=n-u;Math.abs(i)<100&&Math.abs(s)<100&&(a=!0,function(e,t){window.onSendShootDirection(e,t)}(i,-s))}),this.input.on("pointerup",function(e){a&&(a=!1,b())}),this.input.keyboard.on("keydown-SPACE",function(e){window.onSendShoot()}),this.input.keyboard.on("keyup-SPACE",function(e){b()});var o=this;this.input.keyboard.on("keydown-F",function(e){o.scale.isFullscreen?o.scale.stopFullscreen():o.scale.startFullscreen()}),this.input.keyboard.on("keydown-Q",function(e){window.onRotateLeft()}),this.input.keyboard.on("keyup-Q",function(e){window.onClearRotateLeft()}),this.input.keyboard.on("keydown-E",function(e){window.onRotateRight()}),this.input.keyboard.on("keyup-E",function(e){window.onClearRotateRight()}),this.input.keyboard.on("keydown",function(e){var t=y(e.key);t&&m(t)}),this.input.keyboard.on("keyup",function(e){var t=y(e.key);t&&w(t)})},update:function(){n.left.isDown?p("left"):g("left");n.up.isDown?p("up"):g("up");n.right.isDown?p("right"):g("right");n.down.isDown?p("down"):g("down")}}},a=!1,h=100,c=100,l=350,u=100;function d(e){switch(e.name){case"right-arrow":return"right";case"down-arrow":return"down";case"left-arrow":return"left";case"up-arrow":return"up";default:return!1}}function f(e){return-1!==["right-arrow","down-arrow","left-arrow","up-arrow"].indexOf(e.name)}function p(e){i[e]||(console.log("recording direction: ".concat(e)),i[e]=!0,m(e))}function g(e){i[e]&&(i[e]=!1,console.log("unrecord "+e),w(e))}function m(e){window.onDirection(e)}function w(e){window.onClearDirection(e)}function b(){window.onClearShooting()}function y(e){switch(e){case"w":return"up";case"a":return"left";case"s":return"down";case"d":return"right";default:return null}}window.onCreateGame=function(){o=new Phaser.Game(r),window.game=o}},function(e,t,n){"use strict";!function(){var e=function(){if("function"==typeof window.CustomEvent)return window.CustomEvent;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return e.prototype=window.Event.prototype,e}();function t(e,t){var n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n}function n(e,n){var i=e.getAttribute("data-to"),s=t("_method",e.getAttribute("data-method")),o=t("_csrf_token",e.getAttribute("data-csrf")),r=document.createElement("form"),a=e.getAttribute("target");r.method="get"===e.getAttribute("data-method")?"get":"post",r.action=i,r.style.display="hidden",a?r.target=a:n&&(r.target="_blank"),r.appendChild(o),r.appendChild(s),document.body.appendChild(r),r.submit()}window.addEventListener("click",function(t){for(var i=t.target;i&&i.getAttribute;){var s=new e("phoenix.link.click",{bubbles:!0,cancelable:!0});if(!i.dispatchEvent(s))return t.preventDefault(),t.stopImmediatePropagation(),!1;if(i.getAttribute("data-method"))return n(i,t.metaKey||t.shiftKey),t.preventDefault(),!1;i=i.parentNode}},!1),window.addEventListener("phoenix.link.click",function(e){var t=e.target.getAttribute("data-confirm");t&&!window.confirm(t)&&e.preventDefault()},!1)}()},function(e,t,n){},function(e,t,n){e.exports=n(0)}]);